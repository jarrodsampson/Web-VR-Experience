<!DOCTYPE html>
<html lang="en">
<head>
    <title>Device Orientation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <style>
			body {
				color: #61443e;
				font-family:Monospace;
				font-size:13px;
				text-align:center;
				background-color: #000;
				margin: 0px;
				overflow: hidden;
			}

			#info {
                position: absolute;
                top: 10px;
                width: 100%;
                text-align: center;
                z-index: 100;
                display:block;
                color:white;
                font-family:helvetica;
                cursor:pointer;
                z-index:999;
            }
		</style>
</head>
<body>

<div id="container"></div>
<div id="info" onclick="fullscreen()">FullScreen</div>
<script src="three.js"></script>

<script src="FirstPersonControls.js"></script>
<script src="DeviceOrientationControls.js"></script>
<script src="detector.js"></script>

<script>

            var listener = new THREE.AudioListener();
    var sound = new THREE.Audio( listener );
    var audioLoader = new THREE.AudioLoader();

			if ( ! Detector.webgl ) {
				Detector.addGetWebGLMessage();
				document.getElementById( 'container' ).innerHTML = "";
			}
			var container;
			var camera, controls, scene, renderer;
			var mesh, texture, geometry, material;
			var worldWidth = 128, worldDepth = 128,
			worldHalfWidth = worldWidth / 2, worldHalfDepth = worldDepth / 2;
			var clock = new THREE.Clock();
			init();
			animate();
			function init() {
				container = document.getElementById( 'container' );
				camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 1, 20000 );
				camera.position.y = 200;
				controls = new THREE.DeviceOrientationControls( camera );
				//controls = new THREE.FirstPersonControls( camera );
				controls.movementSpeed = 500;
				controls.lookSpeed = 0.2;
				scene = new THREE.Scene();
				scene.fog = new THREE.FogExp2( 0x111111, 0.0007 );
				geometry = new THREE.PlaneGeometry( 20000, 20000, worldWidth - 1, worldDepth - 1 );
				geometry.rotateX( - Math.PI / 2 );
				for ( var i = 0, l = geometry.vertices.length; i < l; i ++ ) {
					//geometry.vertices[ i ].y = 35 * Math.sin( i / 2 );
				}
				var texture = new THREE.TextureLoader().load( "bamboo.jpg" );
				texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
				texture.repeat.set( 100, 100 );
				material = new THREE.MeshBasicMaterial( { map: texture } );
				mesh = new THREE.Mesh( geometry, material );
				scene.add( mesh );
				renderer = new THREE.WebGLRenderer();
				renderer.setClearColor( 0x000000 );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				container.innerHTML = "";
				container.appendChild( renderer.domElement );
				//
				window.addEventListener( 'resize', onWindowResize, false );

//Load a sound and set it as the Audio object's buffer
        audioLoader.load( 'score.mp3', function( buffer ) {
            sound.setBuffer( buffer );
            sound.setLoop(true);
            sound.setVolume(0.5);
            sound.play();
        });


			}
			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
				controls.handleResize();
			}
			//
			function animate() {
				requestAnimationFrame( animate );
				render();
			}
			function render() {
				var delta = clock.getDelta(),
					time = clock.getElapsedTime() * 10;

				mesh.geometry.verticesNeedUpdate = true;
				controls.update( delta );
				renderer.render( scene, camera );
			}

			function fullscreen () {
        if (container.requestFullscreen) {
            container.requestFullscreen();
        } else if (container.msRequestFullscreen) {
            container.msRequestFullscreen();
        } else if (container.mozRequestFullScreen) {
            container.mozRequestFullScreen();
        } else if (container.webkitRequestFullscreen) {
            container.webkitRequestFullscreen();
        }
    }
		</script>

</body>
